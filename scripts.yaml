flash_light:
  mode: restart
  sequence:
  - service: light.turn_on
    target:
      entity_id: light.{{ light }}
  - alias: Cycle light 'count' times
    repeat:
      count: '{{ count|int * 2 - 1 }}'
      sequence:
      - delay: '{{ flash_delay|int }}'
      - service: light.toggle
        target:
          entity_id: light.{{ light }}
test_script:
  alias: Test Script
  sequence:
  - service: media_player.play_media
    target:
      entity_id: media_player.bedroom_speaker
    data:
      media_content_id: spotify://03c29f794c458b50411a5baaf8b060ac/spotify:track:0SjnBEHZVXgCKvOrpvzL2k
      media_content_type: spotify://track
    metadata:
      title: Sundown
      thumbnail: https://i.scdn.co/image/ab67616d0000b2738f2b3a1c0559ca6188de574b
      media_class: track
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: spotify://library
        media_content_id: spotify://03c29f794c458b50411a5baaf8b060ac
      - media_content_type: spotify://current_user_top_tracks
        media_content_id: spotify://03c29f794c458b50411a5baaf8b060ac/current_user_top_tracks
  mode: single
  icon: mdi:party-popper
new_script:
  alias: New Script
  sequence:
  - repeat:
      count: '5'
      sequence:
  mode: single
load_shedding_warning:
  alias: Load Shedding Warning
  sequence:
  - service: tts.google_cloud_say
    data:
      cache: false
      entity_id: media_player.assistant_speakers
      message: "{% set ls = {\n    \"starts\": state_attr(\"binary_sensor.kloofendal_loadshedding_esp\",
        \"startsin\"),\n    \"commences\": as_timestamp(state_attr(\"binary_sensor.kloofendal_loadshedding_esp\",
        \"starts\")) | timestamp_custom(\"%I:%M %p\", true),\n    \"end\": as_timestamp(state_attr(\"binary_sensor.kloofendal_loadshedding_esp\",
        \"ends\")) | timestamp_custom(\"%I:%M %p\", true)\n} %} {% set message = [\n
        \   \"Attention, citizens! We interrupt your regularly scheduled programming
        to bring you an important announcement: in \" ~ ls.starts ~ \" minutes, the
        lights are going out! Load shedding commences at \" ~ ls.commences ~ \" and
        ends at \" ~ ls.end ~ \". Grab your flashlights and prepare for adventure!\",\n
        \   \"Bad news, everyone! In \" ~ ls.starts ~ \" minutes, its lights out thanks
        to everyones favorite pastime: load shedding! The fun begins at \" ~ ls.commences
        ~ \" and ends at \" ~ ls.end ~ \". Time to bust out the candles and board
        games!\",\n    \"Well, well, well, look who's back: load shedding! In \" ~
        ls.starts ~\" minutes, the power's going out. Load shedding kicks off at \"
        ~ ls.commences ~ \" and wraps up at \" ~ ls.end ~ \". Just when you thought
        it was safe to turn on your appliances...\",\n    \"Hold onto your butts,
        folks, because we are in for a bumpy ride! In \" ~ ls.starts ~\" minutes,
        load shedding is coming to town. It all starts at \" ~ ls.commences ~ \" and
        ends at \" ~ ls.end ~ \". Don't say we didn't warn you!\",\n    \"Attention,
        citizens of the world! In \" ~ ls.starts ~\" minutes, the power's taking a
        nap. Load shedding is happening, and it starts at \" ~ ls.commences ~ \" and
        ends at \" ~ ls.end ~ \". So sit back, relax, and enjoy the darkness!\"\n]
        %} {{ message | random }}"
  mode: single
'1703693171590':
  alias: Running Lights Effect with Variables
  variables:
    light_list:
    - light.sonoff_1000fccab0
    - light.sonoff_1000fcc1df
    - light.sonoff_1000f19427
    - light.sonoff_1000fcb60e
    delay_time: 00:00:01
  sequence:
  - repeat:
      count: 5
      sequence:
      - repeat:
          count: '{{ light_list | count }}'
          sequence:
          - service: light.turn_on
            target:
              entity_id: '{{ light_list[repeat.index - 1] }}'
          - delay: '{{ delay_time }}'
          - service: light.turn_off
            target:
              entity_id: '{{ light_list[repeat.index - 1] }}'
  mode: single
